# import json
# import re
#
# # from process_to_word_02 import generate_word_file
# from app_version_01 import process_to_word_02
#
#
# def validate_and_fix_json(ai_output: str):
#     """
#     Validates and fixes AI JSON output.
#     Handles:
#     - Proper JSON directly (no regex needed)
#     - Broken JSON with stray characters
#     - Multi-line text fields
#     """
#
#     # Step 1: Try parsing directly
#     try:
#         parsed = json.loads(ai_output)
#         # Ensure it’s always a list of objects
#         if isinstance(parsed, dict):
#             return [parsed]
#         elif isinstance(parsed, list):
#             return parsed
#     except Exception:
#         pass  # fall back to regex repair if json.loads fails
#
#     # Step 2: Cleanup obvious junk
#     cleaned = re.sub(r'[\n\s]*[-]+[\s,]*', '', ai_output)
#
#     # Step 3: Regex to capture "type" and "text"
#     pattern = r'"type"\s*:\s*"([^"]+)"\s*,\s*"text"\s*:\s*"([\s\S]*?)"(?=\s*(?:,\s*"?type"?\s*:|\s*\}))'
#     matches = re.findall(pattern, cleaned)
#
#     if not matches:
#         return {
#             "error": "No valid objects found. AI output too malformed.",
#             "original_output": ai_output
#         }
#
#     # Step 4: Build list of dicts (no manual escaping!)
#     result = []
#     for typ, text in matches:
#         result.append({"type": typ.strip(), "text": text.strip()})
#
#     return result
#
# from process_to_word_02 import generate_word_file
#
# fixed_text = [{'type': 'heading', 'text': 'Ten Principles of Economics'}, {'type': 'subheading', 'text': 'Understanding the Economy: Household vs. Society'}, {'type': 'paragraph', 'text': 'The word "economy" comes from the Greek word "oikonomos," meaning "one who manages a household." This origin highlights a key similarity: both households and societies face the challenge of managing resources.'}, {'type': 'bullet', 'text': 'A **household** must decide who does which tasks (e.g., cooking, laundry) and how its limited resources (e.g., food, TV access) are distributed among members, considering their abilities, efforts, and desires.'}, {'type': 'bullet', 'text': 'Similarly, a **society** must decide what jobs need to be done (e.g., growing food, making clothing, designing software) and who will do them. After resources (like people, land, buildings, machines) are allocated to these jobs, society must also decide how to distribute the goods and services produced (e.g., who consumes luxury items versus basic necessities).'}, {'type': 'subheading', 'text': 'The Fundamental Problem: Scarcity'}, {'type': 'paragraph', 'text': 'The management of societys resources is critically important because these resources are limited. This fundamental limitation is known as scarcity.'}, {'type': 'bullet', 'text': '**Scarcity means** that society has limited resources and, therefore, cannot produce all the goods and services that people wish to have.'}, {'type': 'bullet', 'text': 'Just as an individual household member cannot get everything they want, each person in a society cannot attain the highest standard of living they might desire due to resource limitations.'}, {'type': 'subheading', 'text': 'What Do Economists Study?'}, {'type': 'paragraph', 'text': 'Economics is defined as the study of how society manages its scarce resources. In most societies, resources are not allocated by a single powerful figure but through the combined actions of millions of households and firms.'}, {'type': 'bullet', 'text': '**Individual Decisions:** Economists study how people make choices, such as how much they work, what they buy, how much they save, and how they invest their savings.'}, {'type': 'bullet', 'text': '**Interactions Among People:** They also examine how people interact, for example, how buyers and sellers collectively determine the price and quantity of goods sold in a market.'}, {'type': 'bullet', 'text': '**Economy as a Whole:** Furthermore, economists analyze broader forces and trends that affect the entire economy, including:The growth in average income.The proportion of the population that is unemployed.The rate at which prices are rising (inflation).'}, {'type': 'subheading', 'text': 'About This Chapter'}, {'type': 'paragraph', 'text': 'This chapter introduces Ten Principles of Economics, offering a foundational overview of the subject. These ideas will be explored in greater depth in subsequent chapters.'}, {'type': 'subheading', 'text': 'Key Definitions'}, {'type': 'bullet', 'text': '**Scarcity:** The limited nature of societys resources.'}, {'type': 'bullet', 'text': '**Economics:** The study of how society manages its scarce resources.'}, {'type': 'heading', 'text': 'How People Make Decisions'}, {'type': 'subheading', 'text': 'Introduction to Economic Decision Making'}, {'type': 'paragraph', 'text': 'An economy is essentially a collection of people interacting and making choices in their daily lives. Whether we look at a local city, a country, or the entire world, the way an economy behaves is a direct reflection of the decisions made by the individuals within it. Therefore, to understand how an economy works, we first need to study how individuals make their decisions.'}, {'type': 'subheading', 'text': 'Key Definitions'}, {'type': 'bullet', 'text': 'Economy: A group of people dealing with one another as they go about their lives, whose collective behavior reflects the individual decisions made by its members.'}, {'type': 'heading', 'text': 'Principle 1: People Face Tradeoffs'}, {'type': 'paragraph', 'text': 'The core idea of economics is that to get one thing we like, we usually have to give up something else we also like. This concept is often summarized by the saying, Theres no such thing as a free lunch. Every decision involves choosing one option and letting go of another.'}, {'type': 'subheading', 'text': 'Tradeoffs for Students'}, {'type': 'paragraph', 'text': 'Consider a student deciding how to use their time, which is a valuable and limited resource.'}, {'type': 'bullet', 'text': 'If she studies economics for an hour, she gives up an hour she could have spent studying psychology.'}, {'type': 'bullet', 'text': 'If she spends an hour studying, she gives up an hour she could have used for napping, bike riding, watching TV, or working for extra money.'}, {'type': 'subheading', 'text': 'Tradeoffs for Families'}, {'type': 'paragraph', 'text': 'Families also face tradeoffs when deciding how to spend their income.'}, {'type': 'bullet', 'text': 'They can buy essentials like food and clothing, or luxuries like a family vacation.'}, {'type': 'bullet', 'text': 'They can choose to spend money now or save it for future goals like retirement or their childrens college education.'}, {'type': 'bullet', 'text': 'Every dollar spent on one item means one less dollar available for another item.'}, {'type': 'subheading', 'text': 'Key Definitions'}, {'type': 'bullet', 'text': 'Tradeoff: The act of giving up one thing in order to gain another, often considered as a balance between two desirable but incompatible features.'}]
#
# generate_word_file(fixed_text,"Ch15")
# # process_to_word_02.generate_word_file(fixed_text,"Ch12")
#
#
#

text_gen = {
  "The Influence of Monetary and Fiscal Policy on Aggregate Demand": "Imagine that you are a member of the Federal Open Market Committee, the group at the Federal Reserve that sets monetary policy. You observe that the president and Congress have agreed to raise taxes. How should the Fed respond to this change in fiscal policy? Should it expand the money supply, contract the money supply, or leave the money supply the same? To answer this question, you need to consider the impact of monetary and fiscal policy on the economy. In the preceding chapter, we used the model of aggregate demand and aggregate supply to explain short-run economic fluctuations. We saw that shifts in the aggregate-demand curve or the aggregate-supply curve cause fluctuations in the economy's overall output of goods and services and its overall level of prices. As we noted in the previous chapter, monetary and fiscal policy can each influence aggregate demand. Thus, a change in one of these policies can lead to short-run fluctuations in output and prices. Policymakers will want to anticipate this effect and, perhaps, adjust the other policy in response. In this chapter, we examine in more detail how the government's policy tools influence the position of the aggregate-demand curve. These tools include monetary policy (the supply of money set by the central bank) and fiscal policy (the levels of government spending and taxation set by the president and Congress). We have previously discussed the long-run effects of these policies. In Chapters 12 and 13, we saw how fiscal policy affects saving, investment, and long-run economic growth. In Chapters 16 and 17, we saw how monetary policy influences the price level in the long run. We now see how these policy tools can shift the aggregate-demand curve and, in doing so, affect macroeconomic variables in the short run. As we have already learned, many factors influence aggregate demand besides monetary and fiscal policy. In particular, desired spending by households and firms determines the overall demand for goods and services. When desired spending changes, aggregate demand shifts. If policymakers do not respond, such shifts in aggregate demand cause short-run fluctuations in output and employment. As a result, monetary and fiscal policymakers sometimes use the policy levers at their disposal to try to offset these shifts in aggregate demand and thereby stabilize the economy. Here we discuss the theory behind these policy actions and some of the difficulties that arise in using this theory in practice.",
  "How Monetary Policy Influences Aggregate Demand": "The aggregate-demand curve shows the total quantity of goods and services demanded in the economy for any price level. The preceding chapter discussed three reasons the aggregate-demand curve slopes downward: \n- The wealth effect: A lower price level raises the real value of households' money holdings, which are part of their wealth. Higher real wealth stimulates consumer spending and thus increases the quantity of goods and services demanded. \n- The interest-rate effect: A lower price level reduces the amount of money people want to hold. As people try to lend out their excess money holdings, the interest rate falls. The lower interest rate stimulates investment spending and thus increases the quantity of goods and services demanded. \n- The exchange-rate effect: When a lower price level reduces the interest rate, investors move some of their funds overseas in search of higher returns. This movement of funds causes the real value of the domestic currency to fall in the market for foreign-currency exchange. Domestic goods become less expensive relative to foreign goods. This change in the real exchange rate stimulates spending on net exports and thus increases the quantity of goods and services demanded. \nThese three effects occur simultaneously to increase the quantity of goods and services demanded when the price level falls and to decrease it when the price level rises. Although all three effects work together to explain the downward slope of the aggregate-demand curve, they are not of equal importance. Because money holdings are a small part of household wealth, the wealth effect is the least important of the three. In addition, because exports and imports represent only a small fraction of U.S. GDP, the exchange-rate effect is not large for the U.S. economy. (This effect is more important for smaller countries, which typically export and import a higher fraction of their GDP.) For the U.S. economy, the most important reason for the downward slope of the aggregate-demand curve is the interest-rate effect. To better understand aggregate demand, we now examine the short-run determination of interest rates in more detail. Here we develop the theory of liquidity preference. This theory of interest-rate determination will help explain the downward slope of the aggregate-demand curve, as well as how monetary and fiscal policy can shift this curve. By shedding new light on aggregate demand, the theory of liquidity preference expands our understanding of what causes short-run economic fluctuations and what policymakers can potentially do about them.",
  "The Theory of Liquidity Preference": "In his classic book *The General Theory of Employment, Interest, and Money*, John Maynard Keynes proposed the theory of liquidity preference to explain the factors that determine an economy's interest rate. The theory is, in essence, an application of supply and demand. According to Keynes, the interest rate adjusts to balance the supply of and demand for money. You may recall that economists distinguish between two interest rates: The nominal interest rate is the interest rate as usually reported, and the real interest rate is the interest rate corrected for the effects of inflation. When there is no inflation, the two rates are the same. But when borrowers and lenders expect prices to rise over the course of the loan, they agree to a nominal interest rate that exceeds the real interest rate by the expected rate of inflation. The higher nominal interest rate compensates for the fact that they expect the loan to be repaid in less valuable dollars. Which interest rate are we now trying to explain with the theory of liquidity preference? The answer is both. In the analysis that follows, we hold constant the expected rate of inflation. This assumption is reasonable for studying the economy in the short run, because expected inflation is typically stable over short periods of time. In this case, nominal and real interest rates differ by a constant. When the nominal interest rate rises or falls, the real interest rate that people expect to earn rises or falls as well. For the rest of this chapter, when we refer to changes in the interest rate, you should envision the real and nominal interest rates moving in the same direction. Let's now develop the theory of liquidity preference by considering the supply and demand for money and how each depends on the interest rate. \n\n**theory of liquidity preference**: Keynes's theory that the interest rate adjusts to bring money supply and money demand into balance",
  "Money Supply": "The first piece of the theory of liquidity preference is the supply of money. As we first discussed in Chapter 16, the money supply in the U.S. economy is controlled by the Federal Reserve. The Fed alters the money supply primarily by changing the quantity of reserves in the banking system through the purchase and sale of government bonds in open-market operations. When the Fed buys government bonds, the dollars it pays for the bonds are typically deposited in banks, and these dollars are added to bank reserves. When the Fed sells government bonds, the dollars it receives for the bonds are withdrawn from the banking system, and bank reserves fall. These changes in bank reserves, in turn, lead to changes in banks' ability to make loans and create money. Thus, by buying and selling bonds in open-market operations, the Fed alters the quantity of money in the economy. In addition to open-market operations, the Fed can influence the money supply using a variety of other tools. One option is for the Fed to change how much it lends to banks. For example, a decrease in the discount rate (the interest rate at which banks can borrow reserves from the Fed) encourages more bank borrowing, which increases bank reserves and thereby the money supply. Conversely, an increase in the discount rate discourages bank borrowing, which decreases bank reserves and the money supply. The Fed also alters the money supply by changing reserve requirements (the amount of reserves banks must hold against deposits) and by changing the interest rate it pays banks on the reserves they are holding. These details of monetary control are important for the implementation of Fed policy, but they are not crucial for the analysis in this chapter. Our goal here is to examine how changes in the money supply affect the aggregate demand for goods and services. For this purpose, we can ignore the details of how Fed policy is implemented and assume that the Fed controls the money supply directly. In other words, the quantity of money supplied in the economy is fixed at whatever level the Fed decides to set it. Because the quantity of money supplied is fixed by Fed policy, it does not depend on other economic variables. In particular, it does not depend on the interest rate. Once the Fed has made its policy decision, the quantity of money supplied is the same, regardless of the prevailing interest rate. We represent a fixed money supply with a vertical supply curve, as in Figure 1. \n\n**Equilibrium in the Money Market (Figure 1 description)**: According to the theory of liquidity preference, the interest rate adjusts to bring the quantity of money supplied and the quantity of money demanded into balance. If the interest rate is above the equilibrium level (such as at r₁), the quantity of money people want to hold (Mᵈ) is less than the quantity the Fed has created, and this surplus of money puts downward pressure on the interest rate. Conversely, if the interest rate is below the equilibrium level (such as at r₂), the quantity of money people want to hold (Mᵈ) is greater than the quantity the Fed has created, and this shortage of money puts upward pressure on the interest rate. Thus, the forces of supply and demand in the market for money push the interest rate toward the equilibrium interest rate, at which people are content holding the quantity of money the Fed has created.",
  "Money Demand": "The second piece of the theory of liquidity preference is the demand for money. As a starting point for understanding money demand, recall that any asset's liquidity refers to the ease with which that asset can be converted into the economy's medium of exchange. Because money is the economy's medium of exchange, it is by definition the most liquid asset available. The liquidity of money explains the demand for it: People choose to hold money instead of other assets that offer higher rates of return because money can be used to buy goods and services. Although many factors determine the quantity of money demanded, the one emphasized by the theory of liquidity preference is the interest rate. The reason is that the interest rate is the opportunity cost of holding money. That is, when you hold wealth as cash in your wallet, instead of as an interest-bearing bond, you lose the interest you could have earned. An increase in the interest rate raises the cost of holding money and, as a result, reduces the quantity of money demanded. A decrease in the interest rate reduces the cost of holding money and raises the quantity demanded. Thus, as shown in Figure 1, the money-demand curve slopes downward.",
  "Equilibrium in the Money Market": "According to the theory of liquidity preference, the interest rate adjusts to balance the supply and demand for money. There is one interest rate, called the equilibrium interest rate, at which the quantity of money demanded exactly balances the quantity of money supplied. If the interest rate is at any other level, people will try to adjust their portfolios of assets and, as a result, drive the interest rate toward the equilibrium. For example, suppose that the interest rate is above the equilibrium level, such as r₁ in Figure 1. In this case, the quantity of money that people want to hold, Mᵈ, is less than the quantity of money that the Fed has supplied. Those people who are holding the surplus of money will try to get rid of it by buying interest-bearing bonds or by depositing it in an interest-bearing bank account. Because bond issuers and banks prefer to pay lower interest rates, they respond to this surplus of money by lowering the interest rates they offer. As the interest rate falls, people become more willing to hold money until, at the equilibrium interest rate, people are happy to hold exactly the amount of money the Fed has supplied. Conversely, at interest rates below the equilibrium level, such as r₂ in Figure 1, the quantity of money that people want to hold, Mᵈ, is greater than the quantity of money that the Fed has supplied. As a result, people try to increase their holdings of money by reducing their holdings of bonds and other interest-bearing assets. As people cut back on their holdings of bonds, bond issuers find that they have to offer higher interest rates to attract buyers. Thus, the interest rate rises and approaches the equilibrium level.",
  "The Downward Slope of the Aggregate-Demand Curve": "Having seen how the theory of liquidity preference explains the economy's equilibrium interest rate, we now consider the theory's implications for the aggregate demand for goods and services. As a warm-up exercise, let's begin by using the theory to reexamine a topic we already understand—the interest-rate effect and the downward slope of the aggregate-demand curve. In particular, suppose that the overall level of prices in the economy rises. What happens to the interest rate that balances the supply and demand for money, and how does that change affect the quantity of goods and services demanded? As we discussed in Chapter 17, the price level is one determinant of the quantity of money demanded. At higher prices, more money is exchanged every time a good or service is sold. As a result, people will choose to hold a larger quantity of money. That is, a higher price level increases the quantity of money demanded for any given interest rate. Thus, an increase in the price level from P₁ to P₂ shifts the money-demand curve to the right from MD₁ to MD₂, as shown in panel (a) of Figure 2. \n\n**The Money Market and the Slope of the Aggregate-Demand Curve (Figure 2 description)**: An increase in the price level from P₁ to P₂ shifts the money-demand curve to the right, as in panel (a). This increase in money demand causes the interest rate to rise from r₁ to r₂. Because the interest rate is the cost of borrowing, the increase in the interest rate reduces the quantity of goods and services demanded from Y₁ to Y₂. This negative relationship between the price level and quantity demanded is represented with a downward-sloping aggregate-demand curve, as in panel (b). \n\nNotice how this shift in money demand affects the equilibrium in the money market. For a fixed money supply, the interest rate must rise to balance money supply and money demand. Because the higher price level has increased the amount of money people want to hold, it has shifted the money demand curve to the right. Yet the quantity of money supplied is unchanged, so the interest rate must rise from r₁ to r₂ to discourage the additional demand. This increase in the interest rate has ramifications not only for the money market but also for the quantity of goods and services demanded, as shown in panel (b). At a higher interest rate, the cost of borrowing and the return to saving are greater. Fewer households choose to borrow to buy a new house, and those who do buy smaller houses, so the demand for residential investment falls. Fewer firms choose to borrow to build new factories and buy new equipment, so business investment falls. Thus, when the price level rises from P₁ to P₂, increasing money demand from MD₁ to MD₂ and raising the interest rate from r₁ to r₂, the quantity of goods and services demanded falls from Y₁ to Y₂. This analysis of the interest-rate effect can be summarized in three steps: (1) A higher price level raises money demand. (2) Higher money demand leads to a higher interest rate. (3) A higher interest rate reduces the quantity of goods and services demanded. The same logic works in reverse: A lower price level reduces money demand, which leads to a lower interest rate, and this in turn increases the quantity of goods and services demanded. The result of this analysis is a negative relationship between the price level and the quantity of goods and services demanded, as illustrated by a downward-sloping aggregate-demand curve.",
  "FYI: Interest Rates in the Long Run and the Short Run": "In an earlier chapter, we said that the interest rate adjusts to balance the supply of loanable funds (national saving) and the demand for loanable funds (desired investment). Here we just said that the interest rate adjusts to balance the supply of and demand for money. Can we reconcile these two theories? To answer this question, we need to focus on three macroeconomic variables: the economy's output of goods and services, the interest rate, and the price level. According to the classical macroeconomic theory we developed earlier in the book, these variables are determined as follows: \n1. Output is determined by the supplies of capital and labor and the available production technology for turning capital and labor into output. (We call this the natural rate of output.) \n2. For any given level of output, the interest rate adjusts to balance the supply and demand for loanable funds. \n3. Given output and the interest rate, the price level adjusts to balance the supply and demand for money. Changes in the supply of money lead to proportionate changes in the price level. \nThese are three of the essential propositions of classical economic theory. Most economists believe that these propositions do a good job of describing how the economy works in the long run. Yet these propositions do not hold in the short run. As we discussed in the preceding chapter, many prices are slow to adjust to changes in the money supply; this fact is reflected in a short-run aggregate-supply curve that is upward sloping rather than vertical. As a result, in the short run, the overall price level cannot, by itself, move to balance the supply of and demand for money. This stickiness of the price level requires the interest rate to move to bring the money market into equilibrium. These changes in the interest rate, in turn, affect the aggregate demand for goods and services. As aggregate demand fluctuates, the economy's output of goods and services moves away from the level determined by factor supplies and technology. To think about the operation of the economy in the short run (day to day, week to week, month to month, or quarter to quarter), it is best to keep in mind the following logic: \n1. The price level is stuck at some level (based on previously formed expectations) and, in the short run, is relatively unresponsive to changing economic conditions. \n2. For any given (stuck) price level, the interest rate adjusts to balance the supply of and demand for money. \n3. The interest rate that balances the money market influences the quantity of goods and services demanded and thus the level of output. \nNotice that this precisely reverses the order of analysis used to study the economy in the long run. The two different theories of the interest rate are useful for different purposes. When thinking about the long-run determinants of interest rates, it is best to keep in mind the loanable-funds theory, which highlights the importance of an economy's saving propensities and investment opportunities. By contrast, when thinking about the short-run determinants of interest rates, it is best to keep in mind the liquidity-preference theory, which highlights the importance of monetary policy.",
  "Changes in the Money Supply": "So far, we have used the theory of liquidity preference to explain more fully how the total quantity of goods and services demanded in the economy changes as the price level changes. That is, we have examined movements along a downward-sloping aggregate-demand curve. The theory also sheds light, however, on some of the other events that alter the quantity of goods and services demanded. Whenever the quantity of goods and services demanded changes for any given price level, the aggregate-demand curve shifts. One important variable that shifts the aggregate-demand curve is monetary policy. To see how monetary policy affects the economy in the short run, suppose that the Fed increases the money supply by buying government bonds in open-market operations. (Why the Fed might do this will become clear later, after we understand the effects of such a move.) Let's consider how this monetary injection influences the equilibrium interest rate for a given price level. This will tell us what the injection does to the position of the aggregate-demand curve. As panel (a) of Figure 3 shows, an increase in the money supply shifts the money-supply curve to the right from MS₁ to MS₂. Because the money-demand curve has not changed, the interest rate falls from r₁ to r₂ to balance money supply and money demand. That is, the interest rate must fall to induce people to hold the additional money the Fed has created, restoring equilibrium in the money market. Once again, the interest rate influences the quantity of goods and services demanded, as shown in panel (b) of Figure 3. The lower interest rate reduces the cost of borrowing and the return to saving. Households buy more and larger houses, stimulating the demand for residential investment. Firms spend more on new factories and new equipment, stimulating business investment. As a result, the quantity of goods and services demanded at a given price level, P, rises from Y₁ to Y₂. Of course, there is nothing special about P: The monetary injection raises the quantity of goods and services demanded at every price level. Thus, the entire aggregate-demand curve shifts to the right. \n\n**A Monetary Injection (Figure 3 description)**: In panel (a), an increase in the money supply from MS₁ to MS₂ reduces the equilibrium interest rate from r₁ to r₂. Because the interest rate is the cost of borrowing, the fall in the interest rate raises the quantity of goods and services demanded at a given price level from Y₁ to Y₂. Thus, in panel (b), the aggregate-demand curve shifts to the right from AD₁ to AD₂. \n\nTo sum up: When the Fed increases the money supply, it lowers the interest rate and increases the quantity of goods and services demanded for any given price level, shifting the aggregate-demand curve to the right. Conversely, when the Fed"}
